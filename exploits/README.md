# XXE Exploits

This directory contains Python scripts demonstrating various XXE attack vectors.

## üéØ Available Exploits

### 1. File Disclosure (`file_disclosure.py`)

Reads arbitrary files from the target server using XXE vulnerability.

**Usage:**
```bash
python file_disclosure.py -t http://localhost:5000 -f /etc/passwd
```

**Options:**
- `-t, --target` : Target URL (required)
- `-f, --file` : File path to read (required)
- `-v, --verbose` : Enable verbose output

**Examples:**

Read /etc/passwd:
```bash
python file_disclosure.py -t http://localhost:5000 -f /etc/passwd
```

Read sensitive data with verbose output:
```bash
python file_disclosure.py -t http://localhost:5000 -f /etc/hosts -v
```

Read application file (use absolute path):
```bash
python file_disclosure.py -t http://localhost:5000 -f /Users/yourname/xxe-security-demo/vulnerable_app/sensitive_data.txt
```

### 2. SSRF Exploit (`ssrf_attack.py`)

Server-Side Request Forgery attack via XXE - forces the server to make HTTP requests.

**Usage:**

Access internal endpoint:
```bash
python ssrf_attack.py -t http://127.0.0.1:5000 -u http://127.0.0.1:5000/health
```

Port scanning:
```bash
python ssrf_attack.py -t http://127.0.0.1:5000 --scan localhost --common-ports
```

Custom port scan:
```bash
python ssrf_attack.py -t http://127.0.0.1:5000 --scan 127.0.0.1 --ports 80,443,8080,3306
```

**Options:**
- `-t, --target` : Vulnerable application URL (required)
- `-u, --url` : Internal URL to access
- `--scan` : Host to port scan
- `--ports` : Comma-separated port list
- `--common-ports` : Scan common ports
- `-v, --verbose` : Verbose output

**Attack Modes:**
1. **Internal Endpoint Access**: Access restricted internal URLs
2. **Port Scanning**: Discover open ports through the vulnerable server

**‚ö†Ô∏è IMPORTANT NOTE:**
Modern versions of lxml block HTTP requests in external entities for security reasons. 
This exploit demonstrates the SSRF attack concept and would work against:
- Older XML parser versions
- Less secure parsers (e.g., some Java XML parsers)
- Custom implementations without network restrictions

In our demonstration environment (lxml with security features), the HTTP SSRF is blocked,
which is actually a **good security practice**. However, the file-based XXE (Task 7) 
still works, showing that lxml is not immune to all XXE attacks.

**Real-world impact:**
- Many production systems still use vulnerable parser configurations
- Facebook's $33.5k XXE bug used OpenID with vulnerable XML parsing
- Android dev tools (APKTool) had XXE SSRF vulnerabilities until 2017

### 3. DoS Exploit (`dos_attack.py`)

*Coming soon...*

## ‚ö†Ô∏è Legal Disclaimer

**EDUCATIONAL PURPOSES ONLY**

These exploits are provided for educational purposes only. Use them only against:
- Your own applications
- Systems you have explicit permission to test
- Lab environments specifically designed for security testing

Unauthorized access to computer systems is illegal. The author and contributors are not responsible for misuse of these tools.

## üîß Requirements
```bash
pip install requests
```

## üìö Learning Resources

- [OWASP XXE](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_(XXE)_Processing)
- [PortSwigger XXE Tutorial](https://portswigger.net/web-security/xxe)